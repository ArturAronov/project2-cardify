<%- contentFor('styles') %>
<%- contentFor('scripts') %>
  <script>
    const paramValue = window.location.pathname.split('/').reverse()[1]

    const generateFlashcards = (flashcards = {}) => {
      return `
    <div class="container d-flex justify-content-center row">
      <h3 class="text-center pt-5">Flashcards</h3>

      <div class="accordion w-75" id="accordionPanelsStayOpenExample">
        ${flashcards.map(element => {
          const {
            id,
            question,
            answer,
            right,
            wrong,
            dateCreated,
            dateUpdated
          } = element

          return `
            <div class="accordion-item">
              <h2 class="accordion-header" id="panelsStayOpen-headingOne-${id}">
                <button
                  class="accordion-button collapsed"
                  type="button"
                  data-bs-toggle="collapse"
                  data-bs-target="#panelsStayOpen-collapseOne-${id}"
                  aria-expanded="false"
                  aria-controls="panelsStayOpen-collapseOne-${id}">
                    ${question}
                </button>
              </h2>
              <div
                id="panelsStayOpen-collapseOne-${id}"
                class="accordion-collapse collapse m-3"
                aria-labelledby="panelsStayOpen-headingOne-${id}">
                <div class="accordion-body p-0">
                  <table class="table table-borderless">
                    <tr>
                      <td class="w-100 card-body">
                        <h6>
                          ${answer}
                        </h6>
                        <div>
                          Right Answers: ${right}
                        </div>
                        <div>
                          Wrong Answers: ${wrong}
                        </div>
                        <div>
                          Date created: ${moment(dateCreated).format("Do MMMM YYYY, dddd, hh:mm A")}
                        </div>
                        <div>
                          Date edited: ${dateUpdated === null ? ' - ' : moment(dateUpdated).format("Do MMMM YYYY, dddd, hh:mm A")}
                        </div>
                      </td>
                      <td>
                        <a href="/my/collections/4/flashcards/${id}/" class="btn btn-outline-primary" role="button">
                          Edit
                        </a>
                      </td>
                    </tr>
                  </table>
                </div>
              </div>
            </div>`
          }).join('')}
      </div>
      <div class="row justify-content-center pt-5">
        <a class="btn btn-primary" href="/my/collections/${paramValue}/new" role="button" style="width: 188px">Add Flashcard</a>
      </div>
    </div>
  `
    }


    const getFlashcardsData = () => {
      axios({
        method: 'GET',
        url: `/api/collections/${paramValue}/flashcards`
      }).then(res => {
        generatePage(res.data)
      }).catch(err => {
        console.log(err)
      })
    }

    const generatePage = info => {
      const $page = $('#pages-flashcards-show')
      const $flashcards = generateFlashcards(info)
      $page.html('').append($flashcards)
    }

    $(document).ready(() => {
      getFlashcardsData()
    })
  </script>
<%- contentFor('body') %>
<div id="pages-flashcards-show" class="container"></div>
